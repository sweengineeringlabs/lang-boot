apiVersion: v1
kind: ConfigMap
metadata:
  name: rustboot-config
  labels:
    app: rustboot-app
    component: backend
    framework: rustboot
data:
  # Application configuration
  APP_NAME: "rustboot-app"
  APP_ENV: "production"

  # Server configuration
  SERVER_HOST: "0.0.0.0"
  SERVER_PORT: "8080"
  SERVER_WORKERS: "4"

  # Metrics and observability
  METRICS_ENABLED: "true"
  METRICS_PORT: "9090"
  METRICS_PATH: "/metrics"

  # Logging configuration
  LOG_LEVEL: "info"
  LOG_FORMAT: "json"
  LOG_OUTPUT: "stdout"

  # Health check configuration
  HEALTH_CHECK_ENABLED: "true"
  HEALTH_CHECK_PATH: "/health"

  # Database configuration (non-sensitive)
  DATABASE_POOL_MIN_CONNECTIONS: "2"
  DATABASE_POOL_MAX_CONNECTIONS: "10"
  DATABASE_POOL_TIMEOUT_SECONDS: "30"
  DATABASE_POOL_IDLE_TIMEOUT_SECONDS: "600"
  DATABASE_POOL_MAX_LIFETIME_SECONDS: "1800"

  # Cache configuration
  CACHE_ENABLED: "true"
  CACHE_TTL_SECONDS: "300"
  CACHE_MAX_SIZE: "1000"

  # HTTP client configuration
  HTTP_CLIENT_TIMEOUT_SECONDS: "30"
  HTTP_CLIENT_MAX_CONNECTIONS: "100"
  HTTP_CLIENT_POOL_IDLE_TIMEOUT_SECONDS: "90"

  # Rate limiting
  RATE_LIMIT_ENABLED: "true"
  RATE_LIMIT_REQUESTS_PER_SECOND: "100"
  RATE_LIMIT_BURST_SIZE: "200"

  # Middleware configuration
  CORS_ENABLED: "true"
  CORS_ALLOW_ORIGINS: "*"
  CORS_ALLOW_METHODS: "GET,POST,PUT,DELETE,OPTIONS"
  CORS_ALLOW_HEADERS: "Content-Type,Authorization"
  CORS_MAX_AGE_SECONDS: "3600"

  # Security headers
  SECURITY_HEADERS_ENABLED: "true"

  # Messaging configuration
  MESSAGING_ENABLED: "false"
  MESSAGING_MAX_RETRIES: "3"
  MESSAGING_RETRY_DELAY_MS: "1000"

  # Resilience configuration
  CIRCUIT_BREAKER_ENABLED: "true"
  CIRCUIT_BREAKER_FAILURE_THRESHOLD: "5"
  CIRCUIT_BREAKER_TIMEOUT_SECONDS: "60"

  # Graceful shutdown
  SHUTDOWN_TIMEOUT_SECONDS: "30"

  # Feature flags
  FEATURE_METRICS: "true"
  FEATURE_TRACING: "true"
  FEATURE_HEALTH_CHECKS: "true"

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: rustboot-app-config
  labels:
    app: rustboot-app
    component: backend
    framework: rustboot
data:
  # Application-specific configuration file
  app.toml: |
    [server]
    host = "0.0.0.0"
    port = 8080
    workers = 4

    [database]
    pool_min_connections = 2
    pool_max_connections = 10
    pool_timeout_seconds = 30

    [cache]
    enabled = true
    ttl_seconds = 300
    max_size = 1000

    [logging]
    level = "info"
    format = "json"

    [observability]
    metrics_enabled = true
    tracing_enabled = true

    [security]
    rate_limit_enabled = true
    cors_enabled = true
